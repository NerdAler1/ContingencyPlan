import discord
import csv
import os

## VARIABLES
client = discord.Client(intents=discord.Intents.all())

# Source,Destination
ChannelAssociations = {
    1304498969304633405:1312939317718552640,
    1304498990141935717:1312939317718552641,
    1304499009473478686:1312939317718552642,
    1304499046089625632:1312939317718552643,
    1304499065786073108:1312939318204960900,
    1304499088221405295:1312939318204960902,
    1304499100749660250:1312939318204960903,
    1304499110497226773:1312939318204960904,
    1304499119494135838:1312939318204960905,
    1304499126326661140:1312939318204960906,
    1304499133247131698:1312939318725316751,
    1304499147675799552:1312939318725316752,
    1304499164369129604:1312939318725316753,
    1304499188079399075:1312939320742641745,
    1304499198351114260:1312939320742641746,
    1304499213488361594:1312939320742641747,
    1304499246736736266:1312939320742641749,
    1304499261282455552:1312939320742641750,
    1304499276818415627:1312939320742641751,
    1304499291745947658:1312939320742641752,
    1074937658226249798:1313012639886082138,
    960987402653036624:1313012660341571645,
    1044175639055450112:131301268462659591,
    1124453936787619860:131301270292634426,
    1225287396858265701:131301272479151322,
    773421979348500483:1314356181262929950,
    773425406149001237:1313012758706524222,
    1047975496366948424:131301276889461968,
    1063904738652979341:131301277847427487,
    1276084613705633834:131301278916123454,
    1222619148564168844:131301280104369356,
    1054889650407350363:131301281122340456,
    1152640729810739211:131301282408314062,
    1276083911918751794:131301283265197260,
    1276004151339253780:131301284153563553,
    1298143251232063498:131301285785999781,
    1141918734173356142:131301374715717233,
    1133877890350587934:131301376156893598,
    1251413978912002078:131301377514589389,
    1073386911370067999:1313013787397324802
}



## FUNCTIONS


    
# WRITE TO CSV FILE
def WriteCSV(msgdata:discord.Message): 
    filename = msgdata.channel.id
    msgdata.content = msgdata.content.replace("\n","쯼")
    # Handle CSV File Not Existing
    if not os.path.isfile(f"ChannelBackups/{filename}.csv"):
        with open(f"ChannelBackups/{filename}.csv", mode='w', newline='', encoding='utf-8') as file:
            writer = csv.writer(file, delimiter="Ɇ", quoting=csv.QUOTE_ALL, quotechar="×")
            writer.writerow(["attachments","author","channel","channel_mentions","content","created_at","embeds","guild","id","pinned","poll","reactions","stickers"])
        
    # Append to CSV File
    with open(f"ChannelBackups/{filename}.csv", mode='a', newline='', encoding='utf-8') as file:
        writer = csv.writer(file ,delimiter="Ɇ", quoting=csv.QUOTE_ALL, quotechar="×")
        writer.writerow([msgdata.attachments,msgdata.author,msgdata.channel.id,msgdata.channel_mentions,msgdata.content,msgdata.created_at,msgdata.embeds,msgdata.guild,msgdata.id,msgdata.pinned,msgdata.poll,msgdata.reactions,msgdata.stickers])
    msgdata.content = msgdata.content.replace("쯼","\n")